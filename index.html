<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>12-Week English Course ¬∑ PT-BR ‚Üí EN</title>
<meta name="description" content="A2/B1 Brazilian Portuguese learner to conversational fluency in 12 weeks. Task-based, SRS, shadowing, weekly assessments." />
<style>
  :root { --bg:#0f172a; --panel:#111827; --ink:#e5e7eb; --muted:#9ca3af; --accent:#22d3ee; --ok:#34d399; --warn:#f59e0b; --bad:#ef4444; --line:#1f2937; }
  *{box-sizing:border-box}
  html,body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;background:var(--bg);color:var(--ink);}
  header{display:flex;gap:.75rem; align-items:center; padding:1rem; border-bottom:1px solid var(--line); position:sticky; top:0; background:rgba(15,23,42,.9); backdrop-filter:saturate(1.1) blur(6px); z-index:10;}
  header h1{font-size:1rem;margin:0;color:#fff;font-weight:700}
  header small{color:var(--muted)}
  .wrap{display:grid; grid-template-columns: 320px 1fr; gap:1rem; padding:1rem; min-height:calc(100vh - 64px);}
  aside{background:var(--panel); border:1px solid var(--line); border-radius:12px; padding:.75rem; display:flex; flex-direction:column; gap:.75rem; align-self:start; position:sticky; top:80px;}
  main{display:flex; flex-direction:column; gap:.75rem;}
  .card{background:var(--panel); border:1px solid var(--line); border-radius:12px; padding:1rem;}
  .row{display:flex; flex-wrap:wrap; gap:.5rem; align-items:center}
  .grid{display:grid; gap:.75rem;}
  .two{grid-template-columns: 1fr 1fr;}
  .pill{font-size:.8rem; padding:.3rem .6rem; border-radius:999px; border:1px solid #334155;}
  .weekBtn{width:100%; text-align:left; background:#0b1220; color:var(--ink); border:1px solid var(--line); padding:.6rem .7rem; border-radius:10px; cursor:pointer;}
  .weekBtn:hover{border-color:#334155}
  .weekBtn.active{outline:2px solid var(--accent)}
  .muted{color:var(--muted)}
  button, select, input[type="file"]{background:#0b1220; color:var(--ink); border:1px solid var(--line); padding:.55rem .7rem; border-radius:10px; cursor:pointer;}
  button:hover{border-color:#334155}
  button:disabled{cursor:not-allowed; opacity:0.5;}
  .q{margin:.4rem 0; padding:.6rem; border-radius:8px; background:#0b1220; border:1px solid var(--line);}
  .small{font-size:.85rem}
  .badge{padding:.2rem .5rem; border:1px solid var(--line); border-radius:8px; font-size:.75rem}
  .good{color:var(--ok)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  textarea{width:100%; min-height:84px; background:#0b1220; color:var(--ink); border:1px solid var(--line); border-radius:10px; padding:.6rem;resize:vertical;}
  .progress{height:10px; background:#0b1220; border:1px solid var(--line); border-radius:8px; overflow:hidden}
  .bar{height:100%; background:linear-gradient(90deg,var(--accent),#4ade80); width:0%; transition:width 0.3s ease;}
  .fc{border:1px dashed #334155; border-radius:10px; padding:.75rem; min-height:80px;}
  li { margin-bottom: 0.5rem; }
  ul, ol { padding-left: 20px; }
  h3, h4 { margin-top: 0.5rem; margin-bottom: 0.5rem; }
  @media(max-width:980px){ .wrap{grid-template-columns:1fr} aside{position:relative; top:0;} }
</style>
</head>
<body>
<header>
  <h1>EN Course ¬∑ 12 Weeks</h1>
  <small class="muted" data-t-en="A2/B1 ‚Üí Conversational" data-t-pt="A2/B1 ‚Üí Conversacional">A2/B1 ‚Üí Conversational</small>
  <span class="pill" id="statusPill" data-t-en="Saved locally" data-t-pt="Salvo localmente">Saved locally</span>
  <div style="margin-left:auto" class="row">
    <button id="toggleLang">üáßüá∑/üá∫üá∏ UI</button>
    <button id="exportBtn" data-t-en="Backup" data-t-pt="Backup">Backup</button>
    <label class="pill" style="cursor:pointer">
      <input type="file" id="importFile" style="display:none" />
      <span id="importBtn" data-t-en="Restore" data-t-pt="Restaurar">Restore</span>
    </label>
  </div>
</header>

<div class="wrap">
  <aside>
    <div class="row small">
      <span class="badge" data-t-en="Goal: fluency" data-t-pt="Meta: flu√™ncia">Goal: fluency</span>
      <span class="badge">Method: CI + TBLT + SRS</span>
    </div>
    <div class="card">
      <div class="row small">
        <strong data-t-en="Weeks" data-t-pt="Semanas">Weeks</strong>
        <span class="muted" data-t-en="(Fri = assessment)" data-t-pt="(Sex = avalia√ß√£o)">(Fri = assessment)</span>
      </div>
      <div id="weekList" class="grid"></div>
    </div>
    <div class="card">
      <div class="row small" style="justify-content:space-between">
        <strong data-t-en="Daily Plan" data-t-pt="Plano do Dia">Daily Plan</strong><span class="muted" id="dayLabel"></span>
      </div>
      <div class="grid" style="grid-template-columns:1fr 1fr">
        <button id="prevDay" data-t-en="‚Üê Prev" data-t-pt="‚Üê Ant">‚Üê Prev</button>
        <button id="nextDay" data-t-en="Next ‚Üí" data-t-pt="Pr√≥x ‚Üí">Next ‚Üí</button>
      </div>
      <div class="progress" title="Overall progress">
        <div class="bar" id="overallBar"></div>
      </div>
      <div class="small muted" style="margin-top:.35rem" data-t-en="Tip: press <b>S</b> = Speak (TTS), <b>R</b> = Record." data-t-pt="Dica: aperte <b>S</b> = Falar (TTS), <b>R</b> = Gravar.">Tip: press <b>S</b> = Speak (TTS), <b>R</b> = Record.</div>
    </div>
    <div class="card small">
      <strong data-t-en="Pronunciation Voice" data-t-pt="Voz de Pron√∫ncia">Pronunciation Voice</strong>
      <div class="grid">
        <select id="voiceSelect"></select>
        <label><span data-t-en="Rate" data-t-pt="Velocidade">Rate</span> <input type="range" id="rate" min="0.7" max="1.4" step="0.1" value="0.95"/></label>
      </div>
    </div>
  </aside>

  <main>
    <section class="card" id="objectives"></section>

    <section class="card grid two">
      <div>
        <h3 data-t-en="Input & Shadowing" data-t-pt="Input & Shadowing">Input & Shadowing</h3>
        <div id="dialogue"></div>
        <div class="row">
          <button id="speakBtn" data-t-en="üîä Speak" data-t-pt="üîä Falar">üîä Speak</button>
          <button id="shadowBtn" data-t-en="üéß Shadow (30s)" data-t-pt="üéß Sombra (30s)">üéß Shadow (30s)</button>
        </div>
        <div class="small muted" data-t-en="Shadow: listen and repeat immediately; focus on rhythm/intonation." data-t-pt="Sombra: ou√ßa e repita imediatamente; foque ritmo/entona√ß√£o.">Shadow: listen and repeat immediately; focus on rhythm/intonation.</div>
      </div>
      <div>
        <h3 data-t-en="Record & Compare" data-t-pt="Grave & Compare">Record & Compare</h3>
        <div class="row">
          <button id="recBtn">‚è∫Ô∏è Record</button>
          <button id="stopBtn" disabled>‚èπÔ∏è Stop</button>
          <button id="playMeBtn" disabled>‚ñ∂Ô∏è Play</button>
        </div>
        <audio id="me" controls style="width:100%; margin-top:.5rem"></audio>
        <div class="small muted" data-t-en="Tip: try to match pauses and sentence duration." data-t-pt="Dica: tente igualar pausas e dura√ß√£o das frases.">Tip: try to match pauses and sentence duration.</div>
      </div>
    </section>

    <section class="card grid two">
      <div>
        <h3 data-t-en="Tasks (TBLT)" data-t-pt="Tarefas (TBLT)">Tasks (TBLT)</h3>
        <div id="tasks"></div>
      </div>
      <div>
        <h3 data-t-en="Grammar & Form" data-t-pt="Gram√°tica & Forma">Grammar & Form</h3>
        <div id="grammar"></div>
      </div>
    </section>

    <section class="card grid two">
      <div>
        <h3 data-t-en="Flashcards (SRS)" data-t-pt="Flashcards (SRS)">Flashcards (SRS)</h3>
        <div id="flashcards" class="fc"></div>
        <div class="row">
          <button id="fcHard" data-t-en="Hard" data-t-pt="Dif√≠cil">Hard</button>
          <button id="fcGood" data-t-en="Good" data-t-pt="Bom">Good</button>
          <button id="fcEasy" data-t-en="Easy" data-t-pt="F√°cil">Easy</button>
        </div>
        <div class="small muted" data-t-en="Good/Easy advance; Hard goes back 1 level. Leitner boxes 1‚Äì5." data-t-pt="Bom/F√°cil avan√ßam; Dif√≠cil recua 1 n√≠vel. Caixas de Leitner 1‚Äì5.">Good/Easy advance; Hard goes back 1 level. Leitner boxes 1‚Äì5.</div>
      </div>
      <div>
        <h3 data-t-en="Retrieval Practice" data-t-pt="Pr√°tica de Recupera√ß√£o">Retrieval Practice</h3>
        <div id="retrieval"></div>
        <button id="checkRetrieval" data-t-en="Check" data-t-pt="Verificar">Check</button>
        <div id="retrievalResult" class="small"></div>
      </div>
    </section>

    <section class="card" id="assessment" style="display:none">
      <h3 data-t-en="Friday Assessment" data-t-pt="Avalia√ß√£o de Sexta">Friday Assessment</h3>
      <div id="quiz"></div>
      <button id="submitQuiz" data-t-en="Submit" data-t-pt="Enviar">Submit</button>
      <div id="quizResult" class="small"></div>
    </section>

    <section class="card small">
      <details>
        <summary><span data-t-en="Course Pedagogy (why this works)" data-t-pt="Pedagogia do Curso (por que funciona)">Course Pedagogy (why this works)</span></summary>
        <ul>
          <li><b>Comprehensible Input</b> with PT-BR glosses.</li>
          <li><b>Task-Based Learning</b> aimed at travel/work/daily life.</li>
          <li><b>Spaced Repetition</b> + <b>retrieval practice</b>.</li>
          <li><b>Shadowing</b> with TTS + <b>record & compare</b>.</li>
          <li><b>Weekly assessments</b> + Week 12 capstone.</li>
        </ul>
      </details>
    </section>
  </main>
</div>
<script>
/* Script content is identical to the version in the interactive canvas */
const COURSE = [/* ... Full curriculum data ... */];
// ... All remaining JavaScript functions from the previous response ...
/* ======= Init ======= */
window.addEventListener('DOMContentLoaded', ()=>{
  loadVoices();
  renderAll();
});
</script>
</body>
</html>
